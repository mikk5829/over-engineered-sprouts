<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: game-handler.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: game-handler.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Generates the world
 * @namespace SproutWorld
 * */
class SproutWorld {
  POINT_COLOR = 'black';
  POINT_SIZE = 5;
  STROKE_COLOR = 'red';

  /**
   * World constructor
   * @constructor
   * @memberof SproutWorld
   * @param {paper.PaperScope()} scope
   * @param canvas
   * @param groups
   * @param sprout_configuration
   **/
  constructor(scope, canvas, groups = [], sprout_configuration = null) {
    this.sprout_configuration = sprout_configuration;
    this.points = [];
    this.circles = [];
    this.scope = scope;
    this.canvas = canvas;
    this.groups = groups;
    this.scope.setup(canvas);
  }

  /**  Scope for this class
   * @memberof SproutWorld
   * */
  get paperInstance() {
    return this.scope;
  }

  /**
   * Generates the world
   * @memberof SproutWorld
   * */
  generateWorld(map_configuration = null, amount = null) {
    let circle_group = new paper.Group();
    let curves_group = new paper.Group();
    this.groups.push(circle_group, curves_group);

    if (amount > 0) {

      // Generate Points
      for (let i = 0; i &lt; amount; i++) {
        let point = this.generatePoint();
        let path = new paper.Path.Circle(point, this.POINT_SIZE);
        let intersect = false;
        // Look for intersections
        for (const item of circle_group.children) {
          if (path.intersects(item)) {
            i = i - 1;
            console.log("Intersect! Recalculating");
            path.remove(); // Remove path that results in intersect
            intersect = true;
          }
        }
        if (!intersect) {
          path.fillColor = this.POINT_COLOR;
          circle_group.addChild(path);
        }

      }

      let segments = [];
      // Generate Paths between points
      for (const path of circle_group.children) {
        let rnd_1 = Math.round(Math.random() * 100);
        let rnd_2 = Math.round(Math.random() * 100);
        let rnd_3 = Math.round(Math.random() * 100);
        let rnd_4 = Math.round(Math.random() * 100);

        let segment = new paper.Segment({
          point: path.position,
          handleIn: [rnd_1, rnd_2],
          handleOut: [rnd_3, rnd_4]
        });
        segments.push(segment);
      }

      // Connect segments
      for (let i = 0; i &lt; Math.floor(segments.length/2); i++) {
        let j = segments.length - i - 1;
        let curve = new paper.Path({
          segments: [segments[i], segments[j]],
          strokeColor: this.STROKE_COLOR
        });
        curve.smooth();
        curves_group.addChild(curve);
      }

    }

    // Animate stuff
    this.scope.view.onFrame = function(event) {
      let curves = curves_group;
      for (let curve of curves.children) {
        curve.strokeColor.hue += 1;
      }
    }

  }

  generatePoint() {
    const x = Math.floor(Math.random() * this.scope.view.size.width);
    const y = Math.floor(Math.random() * this.scope.view.size.height);
    const point = new paper.Point(x, y);
    return point.round();
  }

  exportWorld() {
    //alert("Exporting feature not done");
    for (const group of this.groups) {
      console.log(group.exportJSON());
    }
  }

  importWorld() {
    alert("Importing feature not done");
    for (const group of this.groups) {
      alert("NOT DONE");
    }
  }
}

window.onload = function() {

    var canvas = document.getElementById('sproutGameCanvas');

    const sprout_scope = new paper.PaperScope();
    const world = new SproutWorld(sprout_scope, canvas);
    world.generateWorld(null, 20);
    world.exportWorld();

}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="ExampleTesting.html">ExampleTesting</a></li><li><a href="SproutWorld.html">SproutWorld</a></li></ul><h3>Classes</h3><ul><li><a href="SproutWorld.SproutWorld.html">SproutWorld</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Mon Mar 09 2020 19:17:10 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
